<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>5&nbsp;Public-Key Cryptography</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Crypto:<span class="mywbr"> &nbsp;</span> Cryptographic Operations</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction to the Crypto Library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="factory.html" class="tocviewlink" data-pltdoc="x">Cryptography Providers</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="digest.html" class="tocviewlink" data-pltdoc="x">Message Digests</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="cipher.html" class="tocviewlink" data-pltdoc="x">Symmetric Encryption</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="kdf.html" class="tocviewlink" data-pltdoc="x">Key Derivation and Password Hashing</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="random.html" class="tocviewlink" data-pltdoc="x">Randomness</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>5&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="#%28part._pk-keys%29" class="tocviewlink" data-pltdoc="x">PK Keys and Parameters</a></td></tr><tr><td align="right">5.2&nbsp;</td><td><a href="#%28part._pk-sign%29" class="tocviewlink" data-pltdoc="x">PK Signatures</a></td></tr><tr><td align="right">5.3&nbsp;</td><td><a href="#%28part._pk-encrypt%29" class="tocviewlink" data-pltdoc="x">PK Encryption</a></td></tr><tr><td align="right">5.4&nbsp;</td><td><a href="#%28part._pk-keyagree%29" class="tocviewlink" data-pltdoc="x">PK Key Agreement</a></td></tr><tr><td align="right">5.5&nbsp;</td><td><a href="#%28part._pk-external%29" class="tocviewlink" data-pltdoc="x">PK External Representations</a></td></tr><tr><td align="right"></td><td><a href="#%28part._pk-bibliography%29" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>spec?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>impl?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-pk%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">get-<wbr></wbr>pk</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>sign?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-encrypt~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>encrypt?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-key-agree~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>can-<wbr></wbr>key-<wbr></wbr>agree?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-has-parameters~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>has-<wbr></wbr>parameters?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._pk-keys%29" class="tocsubseclink" data-pltdoc="x">PK Keys and Parameters</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">private-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">public-<wbr></wbr>only-<wbr></wbr>key?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>parameters?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3eparameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;parameters</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">public-<wbr></wbr>key=?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3epublic-only-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;public-<wbr></wbr>only-<wbr></wbr>key</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-pk-parameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>pk-<wbr></wbr>parameters</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>private-<wbr></wbr>key</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._pk-sign%29" class="tocsubseclink" data-pltdoc="x">PK Signatures</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>sign-<wbr></wbr>digest</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>verify-<wbr></wbr>digest</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fsign%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">digest/<span class="mywbr"> &nbsp;</span>sign</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fverify%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">digest/<span class="mywbr"> &nbsp;</span>verify</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._pk-encrypt%29" class="tocsubseclink" data-pltdoc="x">PK Encryption</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-encrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>encrypt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-decrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>decrypt</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.4<tt>&nbsp;</tt></span><a href="#%28part._pk-keyagree%29" class="tocsubseclink" data-pltdoc="x">PK Key Agreement</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-derive-secret%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>derive-<wbr></wbr>secret</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.5<tt>&nbsp;</tt></span><a href="#%28part._pk-external%29" class="tocsubseclink" data-pltdoc="x">PK External Representations</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>key-<wbr></wbr>&gt;datum</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datum-<wbr></wbr>&gt;pk-<wbr></wbr>key</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters-~3edatum%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">pk-<wbr></wbr>parameters-<wbr></wbr>&gt;datum</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-parameters%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datum-<wbr></wbr>&gt;pk-<wbr></wbr>parameters</span></span></a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._pk-bibliography%29" class="tocsubseclink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="cipher.html" title="backward to &quot;4 Symmetric Encryption&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="kdf.html" title="forward to &quot;6 Key Derivation and Password Hashing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>5<tt>&nbsp;</tt><a name="(part._pk)"></a>Public-Key Cryptography</h3><p>Public-key (PK) cryptography covers operations such as
<a href="#%28part._pk-sign%29" data-pltdoc="x">signing</a>, <a href="#%28part._pk-encrypt%29" data-pltdoc="x">encryption</a>, and
<a href="#%28part._pk-keyagree%29" data-pltdoc="x">key agreement</a> between parties that do not
start with any shared secrets. Instead of shared secrets, each party
possesses a keypair consisting of a secret private key and a
widely-published public key. Not all PK cryptosystems support all PK
operations (for example, DSA does not support encryption or secret
derivation), and some PK implementations may support a subset of a PK
cryptosystem&rsquo;s potential operations.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-spec~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-spec?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a PK cryptosystem specifier,
<span class="RktVal">#f</span> otherwise.</div></p><p>A PK cryptosystem specifier is one of the following: <span class="RktVal">'</span><span class="RktVal">rsa</span>,
<span class="RktVal">'</span><span class="RktVal">dsa</span>, <span class="RktVal">'</span><span class="RktVal">dh</span>, or <span class="RktVal">'</span><span class="RktVal">ec</span>. Strictly speaking, it
specifies the information represented by the public and private keys
and the algorithms that operate on that information. For example,
<span class="RktVal">'</span><span class="RktVal">rsa</span> specifies RSA keys with RSAES-* encryption algorithms
and the RSASSA-* signature algorithms, and <span class="RktVal">'</span><span class="RktVal">ec</span> specifies EC
keys with ECDSA signing and ECDH key agreement.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-impl~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-impl?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a PK cryptosystem implementation,
<span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._get-pk))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-pk%29%29" class="RktValDef RktValLink" data-pltdoc="x">get-pk</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span><span class="RktVar">factories</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">factories</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns an implementation of PK algorithm <span class="RktVar">pki</span> from the given
<span class="RktVar">factories</span>. If no factory in <span class="RktVar">factories</span> implements
<span class="RktVar">pki</span>, returns <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-sign~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-sign?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-encrypt~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-encrypt~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-encrypt?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-can-key-agree~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-key-agree~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-can-key-agree?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Indicates whether the cryptosystem implementation <span class="RktVar">pk</span> (or the
implementation corresponding to <span class="RktVar">pk</span>, if <span class="RktVar">pk</span> is a key)
supports signing, encryption, and key agreement, respectively.</div></p><p>Note that the functions only report the capabilities of the
cryptosystem implementation, regardless of the limitations of
<span class="RktVar">pk</span> if <span class="RktVar">pk</span> is a key. For example,
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-can-sign~3f%29%29" class="RktValLink" data-pltdoc="x">pk-can-sign?</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="RktPn">)</span> would return true when <span class="RktVar">pk</span> is an
RSA public-only key, even though signing requires a private key.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-has-parameters~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-has-parameters~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-has-parameters?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#f</span> if the PK cryptosystem represented by <span class="RktVar">pk</span>
uses key parameters, <span class="RktVal">#f</span> otherwise. See <a href="#%28part._pk-keys%29" data-pltdoc="x">PK Keys and Parameters</a> for
more information.</div></p><h4>5.1<tt>&nbsp;</tt><a name="(part._pk-keys)"></a>PK Keys and Parameters</h4><p>A PK keypair consists of public key component and private key
components. A public key is a key that contains the public key
components. In this library, a private key contains both private and
public components, so it can also be used wherever a public key is
required. That is, every private key is also a public key. This
library uses the term &ldquo;public-only key&rdquo; to refer to a public key
that is not a private key.</p><p>In some PK cryptosystems, the public components are further divided
into key-specific values and &ldquo;key parameters.&rdquo; Key parameters are
public quantities that are expensive to compute; they can be generated
once and many keypairs can use the same parameter values. For example,
a DSA key requires a large prime with certain relatively rare
mathematical properties, and so finding such a prime is relatively
expensive, but once a suitable prime is found, generating private keys
is relatively fast, and since the prime is public, many keypairs can
use the same prime. Elliptic curve (EC) cryptography is another
example: the key parameter is the curve equation, and the public and
private key components are points on the curve. In contrast, RSA does
not have key parameters; simple quantities like the size of an RSA
modulus are not key parameters.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a public key or a private key,
<span class="RktVal">#f</span> otherwise. Since all PK keys contain the public key
components, <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span> is a predicate for public keys.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._private-key~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">private-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a private key.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._public-only-key~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">public-only-key?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a public key but not a private
key, <span class="RktVal">#f</span> otherwise. Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-parameters~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-parameters?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a value representing PK key
parameters for some cryptosystem, <span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3eparameters))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3eparameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;parameters</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a value representing the key parameters of <span class="RktVar">pk</span>, or
<span class="RktVal">#f</span> if <span class="RktVar">pk</span>&rsquo;s cryptosystem does not use key parameters.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._public-key~3d~3f))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">public-key=?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk1</span><span class="hspace">&nbsp;</span><span class="RktVar">pk2</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if the public key components of <span class="RktVar">pk1</span> and
<span class="RktVar">pk2</span> are equal, <span class="RktVal">#f</span> otherwise. One use of this
function is to check whether a private key matches some public-only
key.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3epublic-only-key))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3epublic-only-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;public-only-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-only-key~3f%29%29" class="RktValLink" data-pltdoc="x">public-only-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a public-only key <span class="RktVar">pub-pk</span> such that
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._public-key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">public-key=?</a></span><span class="stt"> </span><span class="RktVar">pk</span><span class="stt"> </span><span class="RktVar">pub-pk</span><span class="RktPn">)</span>. If <span class="RktVar">pk</span> is already a
public-only key, the function may simply return <span class="RktVar">pk</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-pk-parameters))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-pk-parameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-pk-parameters</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">pki</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span>[</td><td><span class="RktVar">paramgen-config</span>]<span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">paramgen-config</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._list%2Fc%29%29" class="RktValLink" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Generate PK parameter values for the cryptosystem of <span class="RktVar">pki</span>
using the given configuration options. Unless otherwise specified, the
configuration values are optional, and the default values are
implementation-dependent.</div></p><p><div class="SIntrapara">The following configuration values are recognized for DSA
(<span class="RktVal">'</span><span class="RktVal">dsa</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Generate a prime modulus of
size <span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and
<span class="RktVal">2048</span>.</p></li></ul></div></p><p><div class="SIntrapara">The following configuration values are recognized for DH
(<span class="RktVal">'</span><span class="RktVal">dh</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Generate a prime modulus of
size <span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and
<span class="RktVal">2048</span>.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">generator</span><span class="stt"> </span><span class="RktVar">generator</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Use the given
<span class="RktVar">generator</span>; must be either <span class="RktVal">2</span> or <span class="RktVal">5</span>.</p></li></ul></div></p><p><div class="SIntrapara">The following configuration values are recognized for EC
(<span class="RktVal">'</span><span class="RktVal">ec</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">curve</span><span class="stt"> </span><span class="RktVar">curve-name</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Required. Use the
standard curve named <span class="RktVar">curve-name</span>. Examples include
<span class="RktVal">"NIST P-256"</span> and <span class="RktVal">"secp192r1"</span>.</p></li></ul></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-private-key))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-private-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-private-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>[<span class="RktVar">keygen-config</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pki</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-spec~3f%29%29" class="RktValLink" data-pltdoc="x">pk-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-impl~3f%29%29" class="RktValLink" data-pltdoc="x">pk-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">keygen-config</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._list%2Fc%29%29" class="RktValLink" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Generate a private key from the given PK implementation or PK
parameters. Unless otherwise specified, configuration values are
optional, and the default values are implementation dependent.</div></p><p><div class="SIntrapara">The following configuration values are recognized for RSA
(<span class="RktVal">'</span><span class="RktVal">rsa</span>):
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">nbits</span><span class="stt"> </span><span class="RktVar">nbits</span><span class="RktPn">)</span> &#8212;<wbr></wbr> Generate a modulus of size
<span class="RktVar">nbits</span>. Examples include <span class="RktVal">1024</span> and <span class="RktVal">2048</span>.</p></li></ul></div></p><h4>5.2<tt>&nbsp;</tt><a name="(part._pk-sign)"></a>PK Signatures</h4><p>In PK signing, the sender uses their own private key to sign a
message; any other party can verify the sender&rsquo;s signature using the
sender&rsquo;s public key. Only short messages can be directly signed using
PK cryptosystems (limits are generally proportional to the size of the
PK keys), so a typical process is to compute a digest of the message
and sign the digest. The message and digest signature are sent
together, possibly with additional data. PK signing and verification
is supported by the RSA, DSA, and EC (ECDSA) cryptosystems.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-sign-digest))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-sign-digest</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the signature using the private key <span class="RktVar">pk</span> of
<span class="RktVar">dgst</span> and metadata indicating that <span class="RktVar">dgst</span> was computed
using digest function <span class="RktVar">di</span>. The <span class="RktVar">dgst</span> argument should
be the <span class="RktVar">di</span> digest of some message.</div></p><p>If <span class="RktVar">pk</span> is an RSA private key, then <span class="RktVar">padding</span> selects
between PKCS#1-v1.5 and PSS [<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>]. If <span class="RktVar">padding</span> is
<span class="RktVal">#f</span>, then an implementation-dependent mode is chosen. For all
other cryptosystems, <span class="RktVar">padding</span> must be <span class="RktVal">#f</span>.</p><p>If <span class="RktVar">di</span> is not a digest compatible with <span class="RktVar">pk</span>, or if the
size of <span class="RktVar">dgst</span> is not the digest size of <span class="RktVar">di</span>, or if the
digest size is too large for <span class="RktVar">pk</span>, then an exception is raised.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-verify-digest))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-verify-digest</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">pk</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">di</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dgst</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">sig</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span>[</td><td><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dgst</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">pk</span> verifies that <span class="RktVar">sig</span> is a
valid signature of the message digest <span class="RktVar">dgst</span> using digest
function <span class="RktVar">di</span>, or <span class="RktVal">#f</span> if the signature is invalid.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._digest/sign))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fsign%29%29" class="RktValDef RktValLink" data-pltdoc="x">digest/sign</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/port-ops.html#%28def._%28%28quote._~23~25kernel%29._input-port~3f%29%29" class="RktValLink" data-pltdoc="x">input-port?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._digest/verify))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%2Fverify%29%29" class="RktValDef RktValLink" data-pltdoc="x">digest/verify</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">di</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-spec~3f%29%29" class="RktValLink" data-pltdoc="x">digest-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest-impl~3f%29%29" class="RktValLink" data-pltdoc="x">digest-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/port-ops.html#%28def._%28%28quote._~23~25kernel%29._input-port~3f%29%29" class="RktValLink" data-pltdoc="x">input-port?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">sig</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pss</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Computes or verifies signature of the <span class="RktVar">di</span> message digest of
<span class="RktVar">input</span>; equivalent to calling <span class="RktSym"><a href="digest.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._digest%29%29" class="RktValLink" data-pltdoc="x">digest</a></span> then
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-sign-digest%29%29" class="RktValLink" data-pltdoc="x">pk-sign-digest</a></span> or <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-verify-digest%29%29" class="RktValLink" data-pltdoc="x">pk-verify-digest</a></span>, respectively.</div></p><h4>5.3<tt>&nbsp;</tt><a name="(part._pk-encrypt)"></a>PK Encryption</h4><p>In PK encryption, the sender uses the public key of the intented
receiver to encrypt a message; the receiver decrypts the message with
the receiver&rsquo;s own private key. Only short messages can be directly
encrypted using PK cryptosystems (limits are generally proportional to
the size of the PK keys), so a typical approach is to encrypt the
message using a symmetric cipher with a randomly-generated key
(sometimes called the bulk encryption key) and encrypt that key using
PK cryptography. The symmetric-key-encrypted message and PK-encrypted
symmetric key are sent together, perhaps with additional data such as
a MAC. PK encryption is supported by the RSA cryptosystem.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-encrypt))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-encrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-encrypt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">oaep</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-decrypt))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-decrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-decrypt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">padding</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">msg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">padding</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pkcs1-v1.5</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">oaep</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Encrypt or decrypt, respectively, the message <span class="RktVar">msg</span> using PK
key <span class="RktVar">pk</span>.</div></p><p>If <span class="RktVar">pk</span> is an RSA key, then <span class="RktVar">padding</span> choses between
PKCS#1-v1.5 padding and OAEP padding [<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>]. If <span class="RktVar">padding</span>
is <span class="RktVal">#f</span>, then an implementation-dependent mode is chosen. For
all other cryptosystems, <span class="RktVar">padding</span> must be <span class="RktVal">#f</span>.</p><p>If <span class="RktVar">msg</span> is too large to encrypt using <span class="RktVar">pk</span>, then an
exception is raised.</p><h4>5.4<tt>&nbsp;</tt><a name="(part._pk-keyagree)"></a>PK Key Agreement</h4><p>In PK key agreement (sometimes called key exchange) two parties derive
a shared secret by exchanging public keys. Each party can compute the
secret from their own private key and the other&rsquo;s public key, but it
is believed infeasible for an observer to compute the secret from the
two public keys alone. PK secret derivation is supported by the DH and
ECDH cryptosystems.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-derive-secret))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-derive-secret%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-derive-secret</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">peer-pk</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._private-key~3f%29%29" class="RktValLink" data-pltdoc="x">private-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">peer-pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the shared secret derived from the private key <span class="RktVar">pk</span> and
the public key <span class="RktVar">peer-pk</span>. If <span class="RktVar">peer-pk</span> is a PK key, it
must be a key belonging to the same cryptosystem and implementation as
<span class="RktVar">pk</span>; otherwise an exception is raised. If <span class="RktVar">peer-pk</span> is
a bytestring, an exception is raised if it cannot be interpreted as
public key data.</div></p><p>Note that the derived secret is a deterministic function of the
private keys: if two parties perform secret derivation twice, they
will produce the same secret both times. In addition, the secret is
not uniformly distributed. For these reasons, the derived secret
should not be used directly as a key; instead, it should be used to
generate key material using a process such as described in RFC 2631
[<a href="#%28cite._.R.F.C2631%29" data-pltdoc="x">RFC2631</a>].</p><h4>5.5<tt>&nbsp;</tt><a name="(part._pk-external)"></a>PK External Representations</h4><p>This section describes serialization of public and private keys in
various formats.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-key-~3edatum))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-key-&gt;datum</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._printable%2Fc%29%29" class="RktValLink" data-pltdoc="x">printable/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a datum representing the key <span class="RktVar">pk</span>, where the encoding
is selected by <span class="RktVar">fmt</span>. Unless noted below, the result is a
bytestring (<span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span>). The following <span class="RktVar">fmt</span> options are
supported:</div></p><ul><li><p><span class="RktVal">'</span><span class="RktVal">SubjectPublicKeyInfo</span> &#8212;<wbr></wbr> DER-encoded
SubjectPublicKeyInfo [<a href="#%28cite._.P.K.I.X%29" data-pltdoc="x">PKIX</a>] representation of the public part
of <span class="RktVar">pk</span>. All key types are supported, and an identifier for the
key type is embedded in the encoding.</p><p>For compatibility with OpenSSL, DH keys are encoded using the PKCS #3
identifier and parameters [<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>] rather than those specified
by [<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>].</p></li><li><p><span class="RktVal">'</span><span class="RktVal">PrivateKeyInfo</span> &#8212;<wbr></wbr> DER-encoded PrivateKeyInfo
[<a href="#%28cite._.P.K.C.S8%29" data-pltdoc="x">PKCS8</a>] representation of <span class="RktVar">pk</span>, which must be a private
key. All key types are supported, and an identifier for the key type
is embedded in the encoding.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">RSAPrivateKey</span> &#8212;<wbr></wbr> DER-encoded RSAPrivateKey
[<a href="#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>] representation of <span class="RktVar">pk</span>, which must be an RSA
private key.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">ECPrivateKey</span> &#8212;<wbr></wbr> DER-encoded ECPrivateKey [<a href="#%28cite._.S.E.C1%29" data-pltdoc="x">SEC1</a>]
representation of <span class="RktVar">pk</span>, which must be an EC private key. Only
keys using named curves are supported.</p></li></ul><p>More formats may be added in future versions of this library.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._datum-~3epk-key))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">datum-&gt;pk-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>[<span class="RktVar">factories</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key~3f%29%29" class="RktValLink" data-pltdoc="x">pk-key?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">factories</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td>=</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factories%29%29" class="RktValLink" data-pltdoc="x">crypto-factories</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parses <span class="RktVar">datum</span> and returns a PK key associated with an
implementation from <span class="RktVar">factories</span>. If no implementation in
<span class="RktVar">factories</span> supports <span class="RktVar">fmt</span>, an exception is raised.</div></p><p>See <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-key-~3edatum%29%29" class="RktValLink" data-pltdoc="x">pk-key-&gt;datum</a></span> for information about the <span class="RktVar">fmt</span>
argument.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._pk-parameters-~3edatum))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters-~3edatum%29%29" class="RktValDef RktValLink" data-pltdoc="x">pk-parameters-&gt;datum</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pkp</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._printable%2Fc%29%29" class="RktValLink" data-pltdoc="x">printable/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pkp</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a datum representing the key parameters <span class="RktVar">pkp</span>, where
the encoding is selected by <span class="RktVar">fmt</span>. Unless noted below, the
result is a bytestring (<span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span>). The following <span class="RktVar">fmt</span>
options are supported:</div></p><ul><li><p><span class="RktVal">'</span><span class="RktVal">AlgorithmIdentifier</span> &#8212;<wbr></wbr> DER-encoded
AlgorithmIdentifier [<a href="#%28cite._.P.K.I.X%29" data-pltdoc="x">PKIX</a>] representation of <span class="RktVar">pkp</span>. All
key parameter types are supported, and an identifier for the key
parameter type is embedded in the encoding.</p><p>For compatibility with OpenSSL, the PKCS #3 identifier and parameter
format [<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>] are used rather than those specified by
[<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>].</p></li><li><p><span class="RktVal">'</span><span class="RktVal">DSAParameters</span> &#8212;<wbr></wbr> DER-encoded Dss-Parms [<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>]</p></li><li><p><span class="RktVal">'</span><span class="RktVal">DHParameter</span> &#8212;<wbr></wbr> DER-encoded DHParameter
[<a href="#%28cite._.P.K.C.S3%29" data-pltdoc="x">PKCS3</a>]. Note: this format differs from the DomainParameters
format specified by PKIX.</p></li><li><p><span class="RktVal">'</span><span class="RktVal">EcpkParameters</span> &#8212;<wbr></wbr> DER-encoded EcpkParameters
[<a href="#%28cite._.P.K.I.X-.Alg.Id%29" data-pltdoc="x">PKIX-AlgId</a>] (called ECDomainParameters in [<a href="#%28cite._.S.E.C1%29" data-pltdoc="x">SEC1</a>]).</p></li></ul><p>More formats may be added in future versions of this library.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._datum-~3epk-parameters))"></a><span title="Provided from: crypto"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._datum-~3epk-parameters%29%29" class="RktValDef RktValLink" data-pltdoc="x">datum-&gt;pk-parameters</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>[<span class="RktVar">factories</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._pk-parameters~3f%29%29" class="RktValLink" data-pltdoc="x">pk-parameters?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">datum</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">factories</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td>=</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factories%29%29" class="RktValLink" data-pltdoc="x">crypto-factories</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parses <span class="RktVar">datum</span> and returns a key-parameters value associated
with an implementation in <span class="RktVar">factories</span>. If no implementation is
found that accepts <span class="RktVar">fmt</span>, an exception is raised.</div></p><h4><a name="(part._pk-bibliography)"></a>Bibliography</h4><p><table cellspacing="0" class="RBibliography"><tr><td><a name="(cite._.P.K.C.S1)"></a>[PKCS1]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #1: RSA Cryptography, version 2.1.&rdquo; <a href="http://www.ietf.org/rfc/rfc3447.txt"><span class="stt">http://www.ietf.org/rfc/rfc3447.txt</span></a></span></td></tr><tr><td><a name="(cite._.P.K.C.S3)"></a>[PKCS3]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #3: Diffie-Hellman Key-Agreement Standard.&rdquo; <a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/pkcs-3-diffie-hellman-key-agreement-standar.htm"><span class="stt">http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/pkcs-3-diffie-hellman-key-agreement-standar.htm</span></a></span></td></tr><tr><td><a name="(cite._.P.K.C.S8)"></a>[PKCS8]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;PKCS #8: Private-Key Information Syntax Specification, version 1.2.&rdquo; <a href="http://www.ietf.org/rfc/rfc5208.txt"><span class="stt">http://www.ietf.org/rfc/rfc5208.txt</span></a></span></td></tr><tr><td><a name="(cite._.P.K.I.X)"></a>[PKIX]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 3280: Internet X.509 Public Key Infrastructure: Certificate and CRL Profile.&rdquo; <a href="http://www.ietf.org/rfc/rfc3280.txt"><span class="stt">http://www.ietf.org/rfc/rfc3280.txt</span></a></span></td></tr><tr><td><a name="(cite._.P.K.I.X-.Alg.Id)"></a>[PKIX-AlgId]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 3279: Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile.&rdquo; <a href="http://www.ietf.org/rfc/rfc3279.txt"><span class="stt">http://www.ietf.org/rfc/rfc3279.txt</span></a></span></td></tr><tr><td><a name="(cite._.R.F.C2631)"></a>[RFC2631]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;RFC 2631: Diffie-Hellman Key Agreement Method.&rdquo; <a href="http://www.ietf.org/rfc/rfc2631.txt"><span class="stt">http://www.ietf.org/rfc/rfc2631.txt</span></a></span></td></tr><tr><td><a name="(cite._.S.E.C1)"></a>[SEC1]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">&ldquo;SEC 1: Elliptic Curve Cryptography.&rdquo; <a href="http://www.secg.org/download/aid-780/sec1-v2.pdf"><span class="stt">http://www.secg.org/download/aid-780/sec1-v2.pdf</span></a></span></td></tr></table></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="cipher.html" title="backward to &quot;4 Symmetric Encryption&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="kdf.html" title="forward to &quot;6 Key Derivation and Password Hashing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>